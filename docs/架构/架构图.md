┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│                    AI前端应用生成系统 - 混合架构 + 效率优化                        │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

用户输入: "帮我做一个电商后台"
            │
            ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│  Layer 0: 智能推理层                                              │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                                                                           │  │
│  │   ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐      │  │
│  │   │   意图理解代理   │───▶│   需求推理代理   │───▶│   需求确认代理   │      │  │
│  │   │    (Intent)     │    │  (Reasoning)    │    │   (Confirm)     │      │  │
│  │   └─────────────────┘    └─────────────────┘    └─────────────────┘      │  │
│  │           │                      │                      │                │  │
│  │           ▼                      ▼                      ▼                │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐    │  │
│  │   │                     推理知识库 + 缓存层                           │    │  │
│  │   │  • 应用类型知识库（电商/博客/后台/移动端...）                      │    │  │
│  │   │  • 功能模块知识库（商品管理/订单管理/用户管理...）                  │    │  │
│  │   │  • UI/UX知识库（布局模式/组件规范/交互模式...）                    │    │  │
│  │   │  • 技术栈知识库（React/Vue/状态管理/UI库...）                     │    │  │
│  │   └─────────────────────────────────────────────────────────────────┘    │  │
│  │                                                                           │  │
│  │   输出: 需求规格说明书                                         │  │
│  │                                                                           │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│  Layer 1: 确定性编排内核                                            │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                                                                           │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐    │  │
│  │   │                      执行计划生成器                               │    │  │
│  │   │   • 解析需求规格，生成执行计划                      │    │  │
│  │   │   • 分析任务依赖关系，确定执行顺序                                 │    │  │
│  │   │   • 识别可并行任务，最大化并行度                                   │    │  │
│  │   └─────────────────────────────────────────────────────────────────┘    │  │
│  │                                    │                                      │  │
│  │                                    ▼                                      │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐    │  │
│  │   │                      全局上下文管理器                             │    │  │
│  │   │   • 维护需求规格、设计系统、已生成代码                             │    │  │
│  │   │   • 支持增量更新，避免全量传递                                     │    │  │
│  │   │   • 提供子代理上下文访问接口                                       │    │  │
│  │   └─────────────────────────────────────────────────────────────────┘    │  │
│  │                                    │                                      │  │
│  │                                    ▼                                      │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐    │  │
│  │   │                      子代理调度器                                 │    │  │
│  │   │   • 按执行计划调度子代理                                          │    │  │
│  │   │   • 支持串行/并行/流水线执行模式                                   │    │  │
│  │   │   • 处理异常重试和超时控制                                         │    │  │
│  │   └─────────────────────────────────────────────────────────────────┘    │  │
│  │                                    │                                      │  │
│  │                                    ▼                                      │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐    │  │
│  │   │                      迭代控制器                                   │    │  │
│  │   │   • 接收反思评估结果，决策是否迭代                                 │    │  │
│  │   │   • 生成针对性修复任务                                            │    │  │
│  │   │   • 控制最大迭代次数，防止死循环                                   │    │  │
│  │   └─────────────────────────────────────────────────────────────────┘    │  │
│  │                                                                           │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│  Layer 2: 专业子代理层                                         │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                                                                           │  │
│  │   ┌───────────────────────────────────────────────────────────────────┐  │  │
│  │   │                        Page 子代理                                  │  │  │
│  │   │   职责: 页面结构与布局生成                                          │  │  │
│  │   │   ┌─────────────────────────────────────────────────────────────┐  │  │  │
│  │   │   │ 输入: 需求规格 + 设计系统 + 页面列表                          │  │  │  │
│  │   │   │ 输出: 页面组件代码 + 组件结构 + 样式代码                      │  │  │  │
│  │   │   │ 并行: ⚡ 多页面并行生成                                       │  │  │  │
│  │   │   │ 缓存: 组件模板缓存、布局模式缓存                              │  │  │  │
│  │   │   └─────────────────────────────────────────────────────────────┘  │  │  │
│  │   └───────────────────────────────────────────────────────────────────┘  │  │
│  │                                    │                                      │  │
│  │                                    ▼                                      │  │
│  │   ┌───────────────────────────────────────────────────────────────────┐  │  │
│  │   │                     Interaction 子代理                              │  │  │
│  │   │   职责: 交互逻辑与动效实现                                          │  │  │
│  │   │   ┌─────────────────────────────────────────────────────────────┐  │  │  │
│  │   │   │ 输入: 页面组件代码 + 交互需求                                 │  │  │  │
│  │   │   │ 输出: 事件处理 + 表单验证 + 动效代码 + Hooks                  │  │  │  │
│  │   │   │ 并行: ⚡ 多交互模块并行生成                                   │  │  │  │
│  │   │   │ 缓存: 交互模式缓存、验证规则缓存                              │  │  │  │
│  │   │   └─────────────────────────────────────────────────────────────┘  │  │  │
│  │   └───────────────────────────────────────────────────────────────────┘  │  │
│  │                                    │                                      │  │
│  │                                    ▼                                      │  │
│  │   ┌───────────────────────────────────────────────────────────────────┐  │  │
│  │   │                       State 子代理                                  │  │  │
│  │   │   职责: 状态管理与数据流设计                                        │  │  │
│  │   │   ┌─────────────────────────────────────────────────────────────┐  │  │  │
│  │   │   │ 输入: 页面代码 + 交互代码 + 数据需求                          │  │  │  │
│  │   │   │ 输出: 状态定义 + Store实现 + API封装 + 类型定义               │  │  │  │
│  │   │   │ 并行: ⚡ 多状态模块并行生成                                   │  │  │  │
│  │   │   │ 缓存: 状态模式缓存、API模板缓存                               │  │  │  │
│  │   │   └─────────────────────────────────────────────────────────────┘  │  │  │
│  │   └───────────────────────────────────────────────────────────────────┘  │  │
│  │                                    │                                      │  │
│  │                                    ▼                                      │  │
│  │   ┌───────────────────────────────────────────────────────────────────┐  │  │
│  │   │                       Quality 子代理                                │  │  │
│  │   │   职责: 代码质量保障与优化                                          │  │  │
│  │   │   ┌─────────────────────────────────────────────────────────────┐  │  │  │
│  │   │   │ 输入: 所有已生成代码 + 质量标准                               │  │  │  │
│  │   │   │ 输出: 优化后代码 + 质量报告 + 改进建议                        │  │  │  │
│  │   │   │ 并行: ⚡ 多模块并行检查                                       │  │  │  │
│  │   │   │ 缓存: 最佳实践规则库                                          │  │  │  │
│  │   │   └─────────────────────────────────────────────────────────────┘  │  │  │
│  │   └───────────────────────────────────────────────────────────────────┘  │  │
│  │                                                                           │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│  Layer 3: 反思迭代层                                             │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                                                                           │  │
│  │   ┌─────────────────────────────────────────────────────────────────┐    │  │
│  │   │                      反思评估代理                                  │    │  │
│  │   │   ┌───────────────────────────────────────────────────────────┐  │    │  │
│  │   │   │ 评估维度:                                                  │  │    │  │
│  │   │   │ • 需求匹配度: 是否满足用户原始需求                          │  │    │  │
│  │   │   │ • 一致性检查: 页面间风格、组件、交互是否统一                  │  │    │  │
│  │   │   │ • 代码质量: 可维护性、性能、可访问性                         │  │    │  │
│  │   │   │ • 最佳实践: 是否遵循技术规范                                │  │    │  │
│  │   │   └───────────────────────────────────────────────────────────┘  │    │  │
│  │   │                          │                                        │    │  │
│  │   │              ┌───────────┴───────────┐                            │    │  │
│  │   │              ▼                       ▼                            │    │  │
│  │   │        ┌──────────┐           ┌──────────────┐                    │    │  │
│  │   │        │ 通过 ✓   │           │ 迭代优化 ↻    │                    │    │  │
│  │   │        └────┬─────┘           └──────┬───────┘                    │    │  │
│  │   │             │                        │                            │    │  │
│  │   │             │                        ▼                            │    │  │
│  │   │             │              ┌──────────────────┐                   │    │  │
│  │   │             │              │ 生成针对性修复任务 │                   │    │  │
│  │   │             │              │ 返回编排内核重调度 │                   │    │  │
│  │   │             │              └──────────────────┘                   │    │  │
│  │   │             │                                                       │    │  │
│  │   └─────────────┴─────────────────────────────────────────────────────┘    │  │
│  │                                                                           │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
└───────────────────────────────────┬─────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                                                                 │
│                              输出: 完整前端应用                                   │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                                                                           │  │
│  │   project/                                                                 │  │
│  │   ├── src/                                                                 │  │
│  │   │   ├── pages/          (Page子代理生成)                                 │  │
│  │   │   ├── components/     (Page子代理生成)                                 │  │
│  │   │   ├── hooks/          (Interaction子代理生成)                          │  │
│  │   │   ├── store/          (State子代理生成)                                │  │
│  │   │   ├── api/            (State子代理生成)                                │  │
│  │   │   ├── types/          (State子代理生成)                                │  │
│  │   │   ├── styles/         (设计系统)                                       │  │
│  │   │   └── utils/          (Quality子代理优化)                              │  │
│  │   ├── package.json                                                        │  │
│  │   ├── vite.config.ts                                                      │  │
│  │   └── tsconfig.json                                                       │  │
│  │                                                                           │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
